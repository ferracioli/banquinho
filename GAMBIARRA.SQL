SELECT M.MOCHILEIRO, SUM(M.GASTOS_ATIVIDADES_TOTAIS) AS GASTOS_TOTAIS, M.ORGANIZADOR, M.CODIGO_INTERNO
    FROM ((
        SELECT P.MOCHILEIRO, (SUM(G.GASTOS_GANHOS)) AS GASTOS_ATIVIDADES_TOTAIS, C.ORGANIZADOR, C.CODIGO_INTERNO 
        FROM PARTICIPA P JOIN CARAVANA C
        ON (P.ORGANIZADOR = C.ORGANIZADOR AND P.CODIGO_INTERNO = C.CODIGO_INTERNO) JOIN ITINERARIO I
        ON (C.ORGANIZADOR = I.ORGANIZADOR AND C.CODIGO_INTERNO = I.CODIGO_INTERNO) JOIN ADENTRA AD
        ON (I.ID = AD.ITINERARIO) JOIN ATIVIDADE A
        ON (AD.ITINERARIO = A.ITINERARIO) JOIN GRUPO_DE_PARTICIPANTES G
        ON (A.ID = G.ATIVIDADE) JOIN ENTRA E
        ON (G.ATIVIDADE = E.ATIVIDADE AND G.CATEGORIA = E.CATEGORIA AND P.MOCHILEIRO = E.USUARIO AND E.USUARIO = AD.USUARIO)
        GROUP BY P.MOCHILEIRO, C.ORGANIZADOR, C.CODIGO_INTERNO
    )
    UNION ALL (
        SELECT P.MOCHILEIRO, SUM(AD.CUSTO_BASE) AS CUSTO_BASE_TOTAL, C.ORGANIZADOR, C.CODIGO_INTERNO
    FROM PARTICIPA P JOIN CARAVANA C
    ON (P.ORGANIZADOR = C.ORGANIZADOR AND P.CODIGO_INTERNO = C.CODIGO_INTERNO) JOIN ITINERARIO I
    ON (I.ORGANIZADOR = C.ORGANIZADOR AND I.CODIGO_INTERNO = C.CODIGO_INTERNO) JOIN ADENTRA AD
    ON (I.ID = AD.ITINERARIO AND P.MOCHILEIRO = AD.USUARIO)
    GROUP BY C.ORGANIZADOR, C.CODIGO_INTERNO, P.MOCHILEIRO
    )) AS M
    GROUP BY M.MOCHILEIRO, M.ORGANIZADOR, M.CODIGO_INTERNO;    